---
// Component to display dynamic stats with fallbacks
import { getAllStats } from "../utils/stats";

let stats;
try {
  console.log("Fetching stats at build time...");
  stats = await getAllStats();
  console.log("Successfully fetched stats:", stats);
} catch (error) {
  console.error("Failed to load stats, using fallbacks:");
  console.error("Error type:", error?.constructor?.name);
  console.error("Error message:", (error as Error)?.message || "Unknown error");
  console.error("Full error:", error);
  stats = {
    crates: "1000+",
    stars: "13.4k",
    downloads: "7.1M",
  };
}
---

<div class="landing-stats landing-text-large" style="text-align: center; margin: 1rem 0 3rem 0;">
  <p class="landing-mono">
    <a
      href="https://crates.io/crates/ratatui/reverse_dependencies"
      target="_blank"
      rel="noopener noreferrer"
    >
      <span class="landing-stats-number">{stats.crates}</span> crates
    </a> built with Ratatui
    <a href="https://github.com/ratatui-org/ratatui" target="_blank" rel="noopener noreferrer">
      <span class="landing-stats-number">{stats.stars}</span> stars
    </a> on GitHub
    <a href="https://crates.io/crates/ratatui" target="_blank" rel="noopener noreferrer">
      <span class="landing-stats-number">{stats.downloads}</span> downloads
    </a> on crates.io
  </p>
</div>
